import{createApp as y,ref as n,watch as z,onMounted as T}from"https://unpkg.com/vue@3/dist/vue.esm-browser.js";function S(e,o){var s=o.icon({iconUrl:new URL("/build/assets/medium_risk-eGVVO0mf.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),u=o.icon({iconUrl:new URL("/build/assets/high_danger-EreEzYfv.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),t=o.icon({iconUrl:new URL("/build/assets/gun-e6pOFlTz.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),l=o.icon({iconUrl:new URL("/build/assets/murder-tlFDIjrO.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]});o.marker([-9.659,-35.701],{icon:s}).addTo(e.value),o.marker([-9.659,-35.702],{icon:u}).addTo(e.value),o.marker([-9.659,-35.703],{icon:t}).addTo(e.value),o.marker([-9.659,-35.704],{icon:s}).addTo(e.value),o.marker([-9.659,-35.705],{icon:l}).addTo(e.value),o.heatLayer([[-9.659,-35.701,1],[-9.659,-35.702,2],[-9.659,-35.703,3],[-9.659,-35.704,4],[-9.659,-35.705,5]],{radius:20}).addTo(e.value)}y({setup(){const e=n(""),o=n(!1),s=n([]),u=n([]),t=n({}),l=n({}),d=n({}),a=n([]),h=n(14);let p=new AbortController,m=p.signal;z(e,r=>{p.abort(),p=new AbortController,m=p.signal,fetch("https://nominatim.openstreetmap.org/search.php?q="+encodeURI(r)+"&format=jsonv2&addressdetails=1&polygon_geojson=1",{signal:m}).then(i=>i.json()).then(i=>{s.value=[],u.value=i,i.forEach(c=>{let w=c.display_name.indexOf(","),k=c.display_name.substring(w+1).trim(),A=c.address.postcode!==void 0?` - ${c.address.postcode}`:"";s.value.push({display:`${c.name} <span class="text-black-50 fst-italic">- ${k}${A}</span>`})})}).catch(i=>{i.name!=="AbortError"&&console.error("Another error: ",i)})}),T(()=>{a.value=L.map("map",{zoomControl:!1,attributionControl:!1}).setView([-9.663136558749533,-35.71422457695007],h.value),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(a.value),L.control.zoom({position:"bottomright"}).addTo(a.value),L.control.locate({position:"bottomright",flyTo:!1,drawCircle:!0,showPopup:!1,markerClass:L.circleMarker,strings:{title:"Mostrar minha localização",popup:"Você está dentro de {distance} {unit} deste ponto"},locateOptions:{maxZoom:16}}).addTo(a.value),S(a,L)});function v(r){o.value=!1,e.value="",t.value=u.value[r],f(),g(),b(),new bootstrap.Offcanvas("#LocationInfo").show()}function f(){Object.keys(l.value).length!==0&&a.value.removeLayer(l.value),l.value=L.geoJSON(t.value.geojson,{style:{fill:!1}}),l.value.addTo(a.value)}function g(){Object.keys(d.value).length!==0&&a.value.removeLayer(d.value),d.value=L.marker([Number(t.value.lat),Number(t.value.lon)]),d.value.addTo(a.value)}function b(){let r=t.value.boundingbox.map(Number);r[2]-=.4,a.value.fitBounds([[r[0],r[2]],[r[1],r[3]]])}return{query:e,recommendations:s,barFocus:o,currentLocation:t,selectSearchBarItem:v}}}).mount("#app");
