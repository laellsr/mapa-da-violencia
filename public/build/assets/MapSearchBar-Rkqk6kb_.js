import{createApp as A,ref as t,watch as z,onMounted as T}from"https://unpkg.com/vue@3/dist/vue.esm-browser.js";function S(o,e){var i=e.icon({iconUrl:new URL("http://safetymap.edge.net.br/build/assets/medium_risk-eGVVO0mf.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),u=e.icon({iconUrl:new URL("http://safetymap.edge.net.br/build/assets/high_danger-EreEzYfv.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),n=e.icon({iconUrl:new URL("http://safetymap.edge.net.br/build/assets/gun-e6pOFlTz.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),l=e.icon({iconUrl:new URL("http://safetymap.edge.net.br/build/assets/murder-tlFDIjrO.png",import.meta.url).href,iconSize:[40,60],shadowSize:[50,64],iconAnchor:[20,60],shadowAnchor:[4,62],popupAnchor:[-3,-76]});e.marker([-9.659,-35.701],{icon:i}).addTo(o.value),e.marker([-9.659,-35.702],{icon:u}).addTo(o.value),e.marker([-9.659,-35.703],{icon:n}).addTo(o.value),e.marker([-9.659,-35.704],{icon:i}).addTo(o.value),e.marker([-9.659,-35.705],{icon:l}).addTo(o.value),e.heatLayer([[-9.659,-35.701,1],[-9.659,-35.702,2],[-9.659,-35.703,3],[-9.659,-35.704,4],[-9.659,-35.705,5]],{radius:20}).addTo(o.value)}A({setup(){const o=t(""),e=t(!1),i=t([]),u=t([]),n=t({}),l=t({}),d=t({}),a=t([]),h=t(14);let p=new AbortController,m=p.signal;z(o,r=>{p.abort(),p=new AbortController,m=p.signal,fetch("https://nominatim.openstreetmap.org/search.php?q="+encodeURI(r)+"&format=jsonv2&addressdetails=1&polygon_geojson=1",{signal:m}).then(s=>s.json()).then(s=>{i.value=[],u.value=s,s.forEach(c=>{let w=c.display_name.indexOf(","),y=c.display_name.substring(w+1).trim(),k=c.address.postcode!==void 0?` - ${c.address.postcode}`:"";i.value.push({display:`${c.name} <span class="text-black-50 fst-italic">- ${y}${k}</span>`})})}).catch(s=>{s.name!=="AbortError"&&console.error("Another error: ",s)})}),T(()=>{a.value=L.map("map",{zoomControl:!1,attributionControl:!1}).setView([-9.663136558749533,-35.71422457695007],h.value),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(a.value),L.control.zoom({position:"bottomright"}).addTo(a.value),L.control.locate({position:"bottomright",flyTo:!1,drawCircle:!0,showPopup:!1,markerClass:L.circleMarker,strings:{title:"Mostrar minha localização",popup:"Você está dentro de {distance} {unit} deste ponto"},locateOptions:{maxZoom:16}}).addTo(a.value),S(a,L)});function v(r){e.value=!1,o.value="",n.value=u.value[r],f(),g(),b(),new bootstrap.Offcanvas("#LocationInfo").show()}function f(){Object.keys(l.value).length!==0&&a.value.removeLayer(l.value),l.value=L.geoJSON(n.value.geojson,{style:{fill:!1}}),l.value.addTo(a.value)}function g(){Object.keys(d.value).length!==0&&a.value.removeLayer(d.value),d.value=L.marker([Number(n.value.lat),Number(n.value.lon)]),d.value.addTo(a.value)}function b(){let r=n.value.boundingbox.map(Number);r[2]-=.4,a.value.fitBounds([[r[0],r[2]],[r[1],r[3]]])}return{query:o,recommendations:i,barFocus:e,currentLocation:n,selectSearchBarItem:v}}}).mount("#app");
